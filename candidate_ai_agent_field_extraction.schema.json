{
  "title": "Promotive Conversation Field Extraction",
  "description": "Schema for extracting candidate and shop info plus call metadata/transcript for Promotive.",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "full_name": { "type": "string", "nullable": true, "description": "Candidate's full name as provided or inferred." },
    "first_name": { "type": "string", "nullable": true, "description": "Candidate first name, if available." },
    "last_name": { "type": "string", "nullable": true, "description": "Candidate last name, if available." },
    "email": { "type": "string", "nullable": true, "format": "email", "description": "Candidate email, if present." },
    "phone": {
      "type": "string", "nullable": true,
      "description": "Best callback number in any common US format.",
      "pattern": "^[+]?1?[-.\\s]?\\(?\\d{3}\\)?[-.\\s]?\\d{3}[-.\\s]?\\d{4}$"
    },

    "locations": {
      "type": "array", "nullable": true,
      "description": "Known shop locations, if stated.",
      "items": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "city":  { "type": "string", "nullable": true },
          "state": { "type": "string", "nullable": true, "pattern": "^[A-Z]{2}$", "description": "Two-letter state code" },
          "zip":   { "type": "string", "nullable": true, "pattern": "^\\d{5}(-\\d{4})?$" }
        },
        "required": ["city","state","zip"]
      }
    },

    "currently_employed": { "type": "boolean", "nullable": true, "description": "Whether the candidate is currently employed or not." },
    "employer":           { "type": "string",  "nullable": true, "description": "If the speaker represents a shop, or states their current or previous employer name, capture the shop/employer name." },
    "job_title":          { "type": "string",  "nullable": true, "description": "Current or most recent job title held by the candidate (e.g., 'mechanic', 'technician', 'A-tech', 'Service Advisor', 'B-tech', 'stocker', 'manager', 'foreman', 'service writer')." },
    "category":           { "type": "string",  "nullable": true, "description": "Target role/title the candidate is interested in (e.g., 'Technician', 'Service Advisor', 'Parts Manager', 'Shop Manager', 'Diesel Technician')." },
    "years_experience":   { "type": "integer", "nullable": true, "minimum": 0, "maximum": 60, "description": "Whole number of years the candidate reports." },
    "certifications":     { "type": "array",   "nullable": true, "description": "List of certification strings mentioned (e.g., 'ASE A1', 'State Inspection').", "items": { "type": "string" } },

    "salary_expectations": {
      "type": "object", "nullable": true,
      "additionalProperties": false,
      "properties": {
        "currency":      { "type": "string", "enum": ["USD"] },
        "period":        { "type": "string", "enum": ["hour","year"], "description": "Pay period for the range." },
        "pay_rate_min":  { "type": "number", "minimum": 0 },
        "pay_rate_max":  { "type": "number", "minimum": 0 }
      },
      "required": ["currency","period","pay_rate_min","pay_rate_max"],
      "description": "Desired pay range. If a single number is provided, set both pay_rate_min and pay_rate_max to that value."
    },

    "contact_preference": {
      "type": "string", "nullable": true,
      "enum": ["phone","email","text"],
      "description": "Best way to follow up."
    },
    "willing_to_relocate":       { "type": "boolean", "nullable": true, "description": "Whether the candidate is open to relocation." },
    "english_primary_language":  { "type": "boolean", "nullable": true, "description": "Whether the candidate can speak English fluently based on the conversation." },

    "notes":            { "type": "string", "nullable": true, "description": "Anything relevant that doesn't fit elsewhere (schedule limits, OEM specialties, tools, etc.)." },

    "call_id":          { "type": "string", "nullable": true, "description": "Unique identifier for the call, if available." },
    "call_direction":   { "type": "string", "nullable": true, "enum": ["inbound","outbound"], "description": "Direction of the call." },
    "call_duration":    { "type": "integer","nullable": true, "minimum": 0, "description": "Call length in seconds." },
    "date":             { "type": "string", "nullable": true, "format": "date", "description": "Conversation date (UTC date portion of call_start_time if unsure)." },
    "call_start_time":  { "type": "string", "nullable": true, "format": "date-time", "description": "Call start timestamp (ISO 8601)." },
    "call_end_time":    { "type": "string", "nullable": true, "format": "date-time", "description": "Call end timestamp (ISO 8601)." },
    "from_number":      {
      "type": "string", "nullable": true,
      "description": "Originating number (candidate); same regex as phone.",
      "pattern": "^[+]?1?[-.\\s]?\\(?\\d{3}\\)?[-.\\s]?\\d{3}[-.\\s]?\\d{4}$"
    },
    "to_number":        {
      "type": "string", "nullable": true,
      "description": "Destination number; same regex as phone.",
      "pattern": "^[+]?1?[-.\\s]?\\(?\\d{3}\\)?[-.\\s]?\\d{3}[-.\\s]?\\d{4}$"
    },
    "user_sentiment":   { "type": "string", "nullable": true, "enum": ["Positive","Neutral","Negative"], "description": "High-level sentiment label." },
    "disconnect_reason":{ "type": "string", "nullable": true, "description": "Why the call ended (e.g., user_hangup)." },
    "recording_url":    { "type": "string", "nullable": true, "format": "uri", "description": "Direct URL to call recording, if present.", "pattern": "^https?://[^\\s]+$" }
  },

  "required": [
    "full_name","first_name","last_name","email","phone","locations",
    "currently_employed","employer","job_title","category","years_experience","certifications",
    "salary_expectations","contact_preference","willing_to_relocate","english_primary_language",
    "notes","call_id","call_direction","call_duration","date","call_start_time","call_end_time",
    "user_sentiment","disconnect_reason","from_number","to_number","recording_url"
  ]
}
